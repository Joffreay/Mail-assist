# Configuration de l'environnement pour l'Office Add-in
# Copiez ce fichier vers config.env et remplissez les valeurs

# =============================================================================
# CONFIGURATION OPENAI
# =============================================================================

# Clé API OpenAI (obligatoire pour les fonctionnalités IA)
# Format: sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
OPENAI_API_KEY=sk-your-openai-api-key-here

# Modèle OpenAI à utiliser (gpt-4, gpt-3.5-turbo, etc.)
OPENAI_MODEL=gpt-4

# Nombre maximum de tokens pour les réponses
OPENAI_MAX_TOKENS=4000

# Température de génération (0.0 = déterministe, 1.0 = créatif)
OPENAI_TEMPERATURE=0.7

# =============================================================================
# CONFIGURATION MICROSOFT GRAPH
# =============================================================================

# ID client Azure AD (obligatoire pour Microsoft Graph)
# Format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
GRAPH_CLIENT_ID=your-azure-ad-client-id-here

# ID tenant Azure AD (optionnel, utilise 'common' par défaut)
GRAPH_TENANT_ID=common

# URI de redirection pour l'authentification
GRAPH_REDIRECT_URI=https://localhost:3001/graph-callback.html

# Scopes d'autorisation (séparés par des espaces)
GRAPH_SCOPES=openid profile email Mail.ReadWrite Calendars.Read User.Read

# =============================================================================
# CONFIGURATION DU SERVEUR
# =============================================================================

# Port du serveur webhook
PORT=8080

# Port du serveur de développement
DEV_SERVER_PORT=3001

# Environnement (development, production, test)
NODE_ENV=development

# Mode debug (true/false)
DEBUG=true

# Niveau de log (debug, info, warn, error)
LOG_LEVEL=info

# =============================================================================
# CONFIGURATION DE SÉCURITÉ
# =============================================================================

# Clé secrète pour la validation des webhooks
WEBHOOK_SECRET=your-webhook-secret-here

# Durée de vie des tokens (en secondes)
TOKEN_EXPIRY=3600

# Seuil de rafraîchissement des tokens (en secondes)
TOKEN_REFRESH_THRESHOLD=300

# =============================================================================
# CONFIGURATION DES PERFORMANCES
# =============================================================================

# Taille maximale des requêtes (en bytes)
MAX_REQUEST_SIZE=10mb

# Timeout des requêtes API (en millisecondes)
API_TIMEOUT=30000

# Taille du cache (nombre d'éléments)
CACHE_SIZE=100

# Durée de vie du cache (en millisecondes)
CACHE_TTL=300000

# =============================================================================
# CONFIGURATION DES FONCTIONNALITÉS
# =============================================================================

# Activer les fonctionnalités OpenAI
OPENAI_ENABLED=true

# Activer les fonctionnalités Microsoft Graph
GRAPH_ENABLED=true

# Activer la synchronisation des calendriers
CALENDAR_SYNC_ENABLED=true

# Activer la génération automatique de réponses
AUTO_REPLY_ENABLED=true

# Activer la gestion des catégories
CATEGORIES_ENABLED=true

# =============================================================================
# CONFIGURATION DES LOGS
# =============================================================================

# Activer les logs dans la console
LOG_CONSOLE_ENABLED=true

# Activer les logs dans des fichiers
LOG_FILE_ENABLED=false

# Fichier de log principal
LOG_FILE_PATH=logs/addin.log

# Taille maximale des fichiers de log (en bytes)
LOG_MAX_SIZE=10485760

# Nombre maximum de fichiers de log
LOG_MAX_FILES=5

# =============================================================================
# CONFIGURATION DES TESTS
# =============================================================================

# Activer le mode test
TEST_MODE=false

# Mocker les APIs externes en mode test
MOCK_EXTERNAL_APIS=false

# Timeout des tests unitaires (en millisecondes)
TEST_UNIT_TIMEOUT=5000

# Timeout des tests d'intégration (en millisecondes)
TEST_INTEGRATION_TIMEOUT=30000

# =============================================================================
# CONFIGURATION DE LOCALISATION
# =============================================================================

# Langue par défaut
DEFAULT_LANGUAGE=fr-FR

# Fuseau horaire par défaut
DEFAULT_TIMEZONE=Europe/Paris

# Format de date par défaut
DEFAULT_DATE_FORMAT=DD/MM/YYYY

# Format d'heure par défaut
DEFAULT_TIME_FORMAT=HH:mm

# =============================================================================
# CONFIGURATION DES WEBHOOKS
# =============================================================================

# Activer les webhooks Microsoft Graph
WEBHOOKS_ENABLED=true

# URL de base pour les webhooks
WEBHOOK_BASE_URL=https://your-domain.com

# Endpoint de validation des webhooks
WEBHOOK_VALIDATION_ENDPOINT=/graph/notifications

# Endpoint de réception des notifications
WEBHOOK_NOTIFICATION_ENDPOINT=/graph/notifications

# =============================================================================
# CONFIGURATION DES CERTIFICATS
# =============================================================================

# Chemin vers le certificat SSL (production)
SSL_CERT_PATH=/path/to/ssl/certificate.crt

# Chemin vers la clé privée SSL (production)
SSL_KEY_PATH=/path/to/ssl/private.key

# Chemin vers l'autorité de certification (production)
SSL_CA_PATH=/path/to/ssl/ca-bundle.crt

# =============================================================================
# CONFIGURATION DES PROXIES
# =============================================================================

# Utiliser un proxy HTTP
HTTP_PROXY=http://proxy.company.com:8080

# Utiliser un proxy HTTPS
HTTPS_PROXY=https://proxy.company.com:8080

# Ignorer le proxy pour les hôtes locaux
NO_PROXY=localhost,127.0.0.1,.local

# =============================================================================
# CONFIGURATION DES MÉTIERS
# =============================================================================

# Dossier par défaut pour les emails à traiter
EMAIL_PROCESS_FOLDER=A traiter

# Dossier par défaut pour les emails traités
EMAIL_PROCESSED_FOLDER=Traité

# Dossier par défaut pour les emails ignorés
EMAIL_IGNORED_FOLDER=Ignoré

# Seuil de confiance minimum pour le traitement des emails
EMAIL_CONFIDENCE_THRESHOLD=0.7

# =============================================================================
# NOTES IMPORTANTES
# =============================================================================

# 1. Ne jamais commiter le fichier config.env dans le contrôle de version
# 2. Utiliser des variables d'environnement en production
# 3. Changer les clés secrètes en production
# 4. Vérifier les permissions Azure AD avant déploiement
# 5. Tester toutes les fonctionnalités après modification de la configuration

# =============================================================================
# EXEMPLE DE CONFIGURATION MINIMALE
# =============================================================================

# Pour un développement rapide, vous pouvez utiliser cette configuration minimale :
# OPENAI_API_KEY=sk-your-key-here
# GRAPH_CLIENT_ID=your-client-id-here
# NODE_ENV=development
# DEBUG=true

